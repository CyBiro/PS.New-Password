        [string]$NumberofPasswords = 1,
        [string]$Length = 12,
        [switch]$AsSecureString = $false,
        [string]$SpecialCharacters = 3
    $passwords = @()
    $inputRange = 48..122
    $SpecialCharactersRange = 33, 35, 60, 61, 62, 63, 64
    $exclude = 91..96
    $exclude += 58..64
    $randomRange = $inputRange | Where-Object { $exclude -notcontains $_ }
    For ($j = 0; $j -lt $NumberofPasswords; $j++) {
        $pass = $null
        For ($i = 0; $i -lt ($Length - $SpecialCharacters); $i++) {
            $rnd = (Get-Random -InputObject $randomRange) 
            $char = [char]$rnd
            $pass += $char
        }
        for ($k = 0; $k -lt $SpecialCharacters; $k++) {
            $rnd = (Get-Random -InputObject $SpecialCharactersRange) 
            $char = [char]$rnd
            $pass += $char
        }
        $pass = RandomisePassword $pass
        $passwords += $pass
        
    }
    if ($AsSecureString -eq $true) {
        $passwords = $passwords | ForEach-Object { Write-Warning "Converting the Password $_ to secure string, this is the last time you will see it."; ConvertTo-SecureString -String $_ -AsPlainText -Force }
        return $passwords
    }
    Return $passwords
}

function RandomisePassword {
    [cmdletbinding()]
    param (
        [parameter(Position = 0,
            Mandatory = $true)]
        [string]$Password
    ) 
    $i = 0
    while ($i -ne 3) {
        $CharArry = $Password.ToCharArray()
        $NewPass = $CharArry | Get-Random -Count $CharArry.length
        $Password = -join $NewPass
        $i++
    }
    write-output $Password
